{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\nexports.__esModule = true;\nexports.default = void 0;\nvar _initializerDefineProperty2 = _interopRequireDefault(require(\"@babel/runtime/helpers/initializerDefineProperty\"));\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\nvar _applyDecoratedDescriptor2 = _interopRequireDefault(require(\"@babel/runtime/helpers/applyDecoratedDescriptor\"));\nvar _initializerWarningHelper2 = _interopRequireDefault(require(\"@babel/runtime/helpers/initializerWarningHelper\"));\nvar _invariant = _interopRequireDefault(require(\"../utils/common/invariant\"));\nvar _publishReplayLatestWhileConnected = _interopRequireDefault(require(\"../utils/rx/publishReplayLatestWhileConnected\"));\nvar _lazy = _interopRequireDefault(require(\"../decorators/lazy\"));\nvar _helpers = require(\"./helpers\");\nvar _class, _descriptor, _class2;\nvar Relation = (_class = (_class2 = function () {\n  function Relation(model, relationTableName, columnName, options) {\n    (0, _initializerDefineProperty2.default)(this, \"_cachedObservable\", _descriptor, this);\n    this._model = model;\n    this._relationTableName = relationTableName;\n    this._columnName = columnName;\n    this._isImmutable = options.isImmutable;\n  }\n  var _proto = Relation.prototype;\n  _proto.fetch = function fetch() {\n    var id = this.id;\n    if (id) {\n      return this._model.collections.get(this._relationTableName).find(id);\n    }\n    return Promise.resolve(null);\n  };\n  _proto.then = function then(onFulfill, onReject) {\n    return this.fetch().then(onFulfill, onReject);\n  };\n  _proto.set = function set(record) {\n    this.id = null === record || void 0 === record ? void 0 : record.id;\n  };\n  _proto.observe = function observe() {\n    return this._cachedObservable;\n  };\n  (0, _createClass2.default)(Relation, [{\n    key: \"id\",\n    get: function get() {\n      return this._model._getRaw(this._columnName);\n    },\n    set: function set(newId) {\n      if (this._isImmutable) {\n        (0, _invariant.default)('create' === this._model._preparedState, \"Cannot change property marked as @immutableRelation \".concat(Object.getPrototypeOf(this._model).constructor.name, \" - \").concat(this._columnName));\n      }\n      this._model._setRaw(this._columnName, newId || null);\n    }\n  }]);\n  return Relation;\n}(), _class2._wmelonTag = 'relation', _class2), _descriptor = (0, _applyDecoratedDescriptor2.default)(_class.prototype, \"_cachedObservable\", [_lazy.default], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: function initializer() {\n    return (0, _helpers.createObservable)(this).pipe(_publishReplayLatestWhileConnected.default).refCount();\n  }\n}), _class);\nexports.default = Relation;","map":{"version":3,"names":["_interopRequireDefault","require","exports","__esModule","default","_initializerDefineProperty2","_createClass2","_applyDecoratedDescriptor2","_initializerWarningHelper2","_invariant","_publishReplayLatestWhileConnected","_lazy","_helpers","_class","_descriptor","_class2","Relation","model","relationTableName","columnName","options","_model","_relationTableName","_columnName","_isImmutable","isImmutable","_proto","prototype","fetch","id","collections","get","find","Promise","resolve","then","onFulfill","onReject","set","record","observe","_cachedObservable","key","_getRaw","newId","_preparedState","concat","Object","getPrototypeOf","constructor","name","_setRaw","_wmelonTag","configurable","enumerable","writable","initializer","createObservable","pipe","refCount"],"sources":["/app/node_modules/@nozbe/watermelondb/Relation/index.js"],"sourcesContent":["\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\nexports.__esModule = true;\nexports.default = void 0;\nvar _initializerDefineProperty2 = _interopRequireDefault(require(\"@babel/runtime/helpers/initializerDefineProperty\"));\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\nvar _applyDecoratedDescriptor2 = _interopRequireDefault(require(\"@babel/runtime/helpers/applyDecoratedDescriptor\"));\nvar _initializerWarningHelper2 = _interopRequireDefault(require(\"@babel/runtime/helpers/initializerWarningHelper\"));\nvar _invariant = _interopRequireDefault(require(\"../utils/common/invariant\"));\nvar _publishReplayLatestWhileConnected = _interopRequireDefault(require(\"../utils/rx/publishReplayLatestWhileConnected\"));\nvar _lazy = _interopRequireDefault(require(\"../decorators/lazy\"));\nvar _helpers = require(\"./helpers\");\nvar _class, _descriptor, _class2;\n// Defines a one-to-one relation between two Models (two tables in db)\n// Do not create this object directly! Use `relation` or `immutableRelation` decorators instead\nvar Relation = (_class = (_class2 = /*#__PURE__*/function () {\n  // Used by withObservables to differentiate between object types\n\n  function Relation(model, relationTableName, columnName, options) {\n    (0, _initializerDefineProperty2.default)(this, \"_cachedObservable\", _descriptor, this);\n    this._model = model;\n    this._relationTableName = relationTableName;\n    this._columnName = columnName;\n    this._isImmutable = options.isImmutable;\n  }\n  var _proto = Relation.prototype;\n  _proto.fetch = function fetch() {\n    var {\n      id: id\n    } = this;\n    if (id) {\n      return this._model.collections.get(this._relationTableName).find(id);\n    }\n    return Promise.resolve(null);\n  };\n  _proto.then = function then(onFulfill, onReject) {\n    // $FlowFixMe\n    return this.fetch().then(onFulfill, onReject);\n  };\n  _proto.set = function set(record) {\n    this.id = null === record || void 0 === record ? void 0 : record.id;\n  };\n  _proto.observe = function observe() {\n    return this._cachedObservable;\n  };\n  (0, _createClass2.default)(Relation, [{\n    key: \"id\",\n    get: function get() {\n      return this._model._getRaw(this._columnName);\n    },\n    set: function set(newId) {\n      if (this._isImmutable) {\n        (0, _invariant.default)('create' === this._model._preparedState, \"Cannot change property marked as @immutableRelation \".concat(Object.getPrototypeOf(this._model).constructor.name, \" - \").concat(this._columnName));\n      }\n      this._model._setRaw(this._columnName, newId || null);\n    }\n  }]);\n  return Relation;\n}(), _class2._wmelonTag = 'relation', _class2), (_descriptor = (0, _applyDecoratedDescriptor2.default)(_class.prototype, \"_cachedObservable\", [_lazy.default], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: function initializer() {\n    return (0, _helpers.createObservable)(this).pipe(_publishReplayLatestWhileConnected.default).refCount();\n  }\n})), _class);\nexports.default = Relation;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}